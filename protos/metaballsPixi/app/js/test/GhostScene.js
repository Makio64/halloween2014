var Ghost, GhostScene,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

GhostScene = (function(_super) {
  __extends(GhostScene, _super);

  function GhostScene() {
    this.onMouseMove = __bind(this.onMouseMove, this);
    this.onTouchMove = __bind(this.onTouchMove, this);
    var blur, gui, metaball;
    GhostScene.__super__.constructor.call(this);
    this.mousePosition = new PIXI.Point();
    this.bg = new PIXI.Graphics();
    this.bg.beginFill(0x111111, 1);
    this.bg.drawRect(0, 0, window.innerWidth, window.innerHeight);
    this.bg.endFill();
    if (!isMobile.any) {
      this.backgroundFilter = new BackgroundFilter();
      this.bg.filters = [this.backgroundFilter];
    }
    this.bg.bounds = new PIXI.Rectangle(0, 0, window.innerWidth, window.innerHeight);
    Stage2d.addChild(this.bg);
    this.container = new PIXI.DisplayObjectContainer();
    this.addChild(this.container);
    this.hack = new PIXI.Graphics();
    this.hack.beginFill(0xFF0000, 1);
    this.hack.drawRect(0, 0, 0, 0);
    this.hack.position.x = window.innerWidth;
    this.hack.position.y = window.innerHeight;
    this.hack.endFill();
    this.container.addChild(this.hack);
    this.ghost = new Ghost();
    this.ghost2 = new Ghost(this.ghost.points);
    setTimeout((function(_this) {
      return function() {
        _this.container.addChild(_this.ghost);
        _this.addChild(_this.ghost2);
      };
    })(this), 1000);
    blur = new PIXI.BlurFilter();
    blur.blurX = blur.blurY = 30;
    metaball = new MetaballFilter();
    gui = new dat.GUI();
    gui.add(blur, 'blurX', 0, 100);
    gui.add(blur, 'blurY', 0, 100);
    gui.add(metaball.uniforms.min, 'value', 0, 1);
    gui.add(this.ghost.scale, 'x', 0, 1);
    gui.add(this.ghost.scale, 'y', 0, 1);
    gui.close();
    this.container.filters = [blur, metaball];
    return;
  }

  GhostScene.prototype.transitionIn = function() {
    window.addEventListener('mousemove', this.onMouseMove);
    window.addEventListener('touchmove', this.onTouchMove);
    GhostScene.__super__.transitionIn.call(this);
  };

  GhostScene.prototype.onTouchMove = function(e) {
    this.mousePosition.x = e.touches[0].pageX / 2;
    this.mousePosition.y = e.touches[0].pageY / 2;
  };

  GhostScene.prototype.onMouseMove = function(e) {
    this.mousePosition.x = e.pageX;
    this.mousePosition.y = e.pageY;
  };

  GhostScene.prototype.update = function(dt) {
    if (this.backgroundFilter) {
      this.backgroundFilter.uniforms.time.value = Math.random();
    }
    this.ghost.points[0].x = this.mousePosition.x / this.ghost.scale.x;
    this.ghost.points[0].y = this.mousePosition.y / this.ghost.scale.y;
    this.ghost.update();
    this.ghost2.scale.x = this.ghost.scale.x;
    this.ghost2.scale.y = this.ghost.scale.y;
  };

  GhostScene.prototype.resize = function() {
    this.bg.clear();
    this.bg.beginFill(0xFF0000, 1);
    this.bg.drawRect(0, 0, window.innerWidth, window.innerHeight);
    this.bg.endFill();
    this.bg.bounds = new PIXI.Rectangle(0, 0, window.innerWidth, window.innerHeight);
    this.hack.position.x = window.innerWidth;
    this.hack.position.y = window.innerHeight;
  };

  return GhostScene;

})(Scene);

Ghost = (function(_super) {
  __extends(Ghost, _super);

  function Ghost(points) {
    var count, i, length, texture, _i;
    count = 40;
    if (isMobile.any) {
      count = 20;
    }
    length = 400 / count;
    if (points === void 0) {
      points = [];
      for (i = _i = 0; _i < count; i = _i += 1) {
        points.push(new PIXI.Point(i * length, Math.random() * 30));
      }
    }
    texture = PIXI.Texture.fromImage("img/ghost.png");
    Ghost.__super__.constructor.call(this, texture, points);
    this.scale.x = .5;
    this.scale.y = .5;
    return;
  }

  Ghost.prototype.update = function() {
    var current, dx, dy, i, previous, _i, _ref, _results;
    _results = [];
    for (i = _i = 1, _ref = this.points.length; _i < _ref; i = _i += 1) {
      current = this.points[i];
      previous = this.points[i - 1];
      dx = current.x - previous.x;
      dy = current.y - previous.y;
      if ((dx * dx + dy * dy) > 250) {
        current.x += (previous.x - current.x) * (.25 + i * .005);
        _results.push(current.y += (previous.y - current.y) * (.25 + i * .005));
      } else {
        _results.push(void 0);
      }
    }
    return _results;
  };

  return Ghost;

})(PIXI.Rope);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvR2hvc3RTY2VuZS5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBQSxpQkFBQTtFQUFBOztpU0FBQTs7QUFBQTtBQUVDLCtCQUFBLENBQUE7O0FBQVksRUFBQSxvQkFBQSxHQUFBO0FBQ1gscURBQUEsQ0FBQTtBQUFBLHFEQUFBLENBQUE7QUFBQSxRQUFBLG1CQUFBO0FBQUEsSUFBQSwwQ0FBQSxDQUFBLENBQUE7QUFBQSxJQUNBLElBQUMsQ0FBQSxhQUFELEdBQXFCLElBQUEsSUFBSSxDQUFDLEtBQUwsQ0FBQSxDQURyQixDQUFBO0FBQUEsSUFHQSxJQUFDLENBQUEsRUFBRCxHQUFVLElBQUEsSUFBSSxDQUFDLFFBQUwsQ0FBQSxDQUhWLENBQUE7QUFBQSxJQUlBLElBQUMsQ0FBQSxFQUFFLENBQUMsU0FBSixDQUFjLFFBQWQsRUFBdUIsQ0FBdkIsQ0FKQSxDQUFBO0FBQUEsSUFLQSxJQUFDLENBQUEsRUFBRSxDQUFDLFFBQUosQ0FBYSxDQUFiLEVBQWUsQ0FBZixFQUFpQixNQUFNLENBQUMsVUFBeEIsRUFBbUMsTUFBTSxDQUFDLFdBQTFDLENBTEEsQ0FBQTtBQUFBLElBTUEsSUFBQyxDQUFBLEVBQUUsQ0FBQyxPQUFKLENBQUEsQ0FOQSxDQUFBO0FBT0EsSUFBQSxJQUFHLENBQUEsUUFBUyxDQUFDLEdBQWI7QUFDQyxNQUFBLElBQUMsQ0FBQSxnQkFBRCxHQUF3QixJQUFBLGdCQUFBLENBQUEsQ0FBeEIsQ0FBQTtBQUFBLE1BQ0EsSUFBQyxDQUFBLEVBQUUsQ0FBQyxPQUFKLEdBQWMsQ0FBQyxJQUFDLENBQUEsZ0JBQUYsQ0FEZCxDQUREO0tBUEE7QUFBQSxJQVVBLElBQUMsQ0FBQSxFQUFFLENBQUMsTUFBSixHQUFpQixJQUFBLElBQUksQ0FBQyxTQUFMLENBQWUsQ0FBZixFQUFpQixDQUFqQixFQUFtQixNQUFNLENBQUMsVUFBMUIsRUFBcUMsTUFBTSxDQUFDLFdBQTVDLENBVmpCLENBQUE7QUFBQSxJQVdBLE9BQU8s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bEJXO0VBQUEsQ0FBWjs7QUFBQSxrQkFvQkEsTUFBQSxHQUFPLFNBQUEsR0FBQTtBQUtOLFFBQUEsZ0RBQUE7QUFBQTtTQUFTLDZEQUFULEdBQUE7QUFDQyxNQUFBLE9BQUEsR0FBVSxJQUFDLENBQUEsTUFBTyxDQUFBLENBQUEsQ0FBbEIsQ0FBQTtBQUFBLE1BQ0EsUUFBQSxHQUFXLElBQUMsQ0FBQSxNQUFPLENBQUEsQ0FBQSxHQUFFLENBQUYsQ0FEbkIsQ0FBQTtBQUFBLE1BRUEsRUFBQSxHQUFLLE9BQU8sQ0FBQyxDQUFSLEdBQVksUUFBUSxDQUFDLENBRjFCLENBQUE7QUFBQSxNQUdBLEVBQUEsR0FBSyxPQUFPLENBQUMsQ0FBUixHQUFZLFFBQVEsQ0FBQyxDQUgxQixDQUFBO0FBSUEsTUFBQSxJQUFHLENBQUMsRUFBQSxHQUFHLEVBQUgsR0FBTSxFQUFBLEdBQUcsRUFBVixDQUFBLEdBQWMsR0FBakI7QUFDQyxRQUFBLE9BQU8sQ0FBQyxDQUFSLElBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBVCxHQUFhLE9BQU8sQ0FBQyxDQUF0QixDQUFBLEdBQXlCLENBQUMsR0FBQSxHQUFJLENBQUEsR0FBRSxJQUFQLENBQXRDLENBQUE7QUFBQSxzQkFDQSxPQUFPLENBQUMsQ0FBUixJQUFhLENBQUMsUUFBUSxDQUFDLENBQVQsR0FBYSxPQUFPLENBQUMsQ0FBdEIsQ0FBQSxHQUF5QixDQUFDLEdBQUEsR0FBSSxDQUFBLEdBQUUsSUFBUCxFQUR0QyxDQUREO09BQUEsTUFBQTs4QkFBQTtPQUxEO0FBQUE7b0JBTE07RUFBQSxDQXBCUCxDQUFBOztlQUFBOztHQUZtQixJQUFJLENBQUMsS0E1RnpCLENBQUEiLCJmaWxlIjoidGVzdC9HaG9zdFNjZW5lLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgR2hvc3RTY2VuZSBleHRlbmRzIFNjZW5lXG5cblx0Y29uc3RydWN0b3I6KCktPlxuXHRcdHN1cGVyKClcblx0XHRAbW91c2VQb3NpdGlvbiA9IG5ldyBQSVhJLlBvaW50KClcblxuXHRcdEBiZyA9IG5ldyBQSVhJLkdyYXBoaWNzKClcblx0XHRAYmcuYmVnaW5GaWxsKDB4MTExMTExLDEpXG5cdFx0QGJnLmRyYXdSZWN0KDAsMCx3aW5kb3cuaW5uZXJXaWR0aCx3aW5kb3cuaW5uZXJIZWlnaHQpXG5cdFx0QGJnLmVuZEZpbGwoKVxuXHRcdGlmICFpc01vYmlsZS5hbnlcblx0XHRcdEBiYWNrZ3JvdW5kRmlsdGVyID0gbmV3IEJhY2tncm91bmRGaWx0ZXIoKVxuXHRcdFx0QGJnLmZpbHRlcnMgPSBbQGJhY2tncm91bmRGaWx0ZXJdXG5cdFx0QGJnLmJvdW5kcyA9IG5ldyBQSVhJLlJlY3RhbmdsZSgwLDAsd2luZG93LmlubmVyV2lkdGgsd2luZG93LmlubmVySGVpZ2h0KVxuXHRcdFN0YWdlMmQuYWRkQ2hpbGQoQGJnKVxuXG5cdFx0QGNvbnRhaW5lciA9IG5ldyBQSVhJLkRpc3BsYXlPYmplY3RDb250YWluZXIoKVxuXHRcdEBhZGRDaGlsZChAY29udGFpbmVyKVxuXG5cdFx0QGhhY2sgPSBuZXcgUElYSS5HcmFwaGljcygpXG5cdFx0QGhhY2suYmVnaW5GaWxsKDB4RkYwMDAwLDEpXG5cdFx0QGhhY2suZHJhd1JlY3QoMCwwLDAsMClcblx0XHRAaGFjay5wb3NpdGlvbi54ID0gd2luZG93LmlubmVyV2lkdGhcblx0XHRAaGFjay5wb3NpdGlvbi55ID0gd2luZG93LmlubmVySGVpZ2h0XG5cdFx0QGhhY2suZW5kRmlsbCgpXG5cdFx0QGNvbnRhaW5lci5hZGRDaGlsZChAaGFjaylcblxuXHRcdEBnaG9zdCA9IG5ldyBHaG9zdCgpXG5cdFx0QGdob3N0MiA9IG5ldyBHaG9zdChAZ2hvc3QucG9pbnRzKVxuXHRcdCMgY29uc29sZS5sb2cgUElYSS5ibGVuZE1vZGVzXG5cdFx0IyBAZ2hvc3QyLmJsZW5kTW9kZSA9IFBJWEkuYmxlbmRNb2Rlcy5NVUxUSVBMWVxuXG5cdFx0IyBAZ2hvc3QyXG5cdFx0c2V0VGltZW91dCAoKT0+XG5cdFx0XHRAY29udGFpbmVyLmFkZENoaWxkKEBnaG9zdClcblx0XHRcdEBhZGRDaGlsZChAZ2hvc3QyKVxuXHRcdFx0cmV0dXJuXG5cdFx0LDEwMDBcblxuXHRcdGJsdXIgPSBuZXcgUElYSS5CbHVyRmlsdGVyKClcblx0XHRibHVyLmJsdXJYID0gYmx1ci5ibHVyWSA9IDMwXG5cdFx0bWV0YWJhbGwgPSBuZXcgTWV0YWJhbGxGaWx0ZXIoKVxuXG5cdFx0Z3VpID0gbmV3IGRhdC5HVUkoKVxuXHRcdGd1aS5hZGQoYmx1ciwnYmx1clgnLDAsMTAwKVxuXHRcdGd1aS5hZGQoYmx1ciwnYmx1clknLDAsMTAwKVxuXHRcdGd1aS5hZGQobWV0YWJhbGwudW5pZm9ybXMubWluLCd2YWx1ZScsMCwxKVxuXHRcdGd1aS5hZGQoQGdob3N0LnNjYWxlLCd4JywwLDEpXG5cdFx0Z3VpLmFkZChAZ2hvc3Quc2NhbGUsJ3knLDAsMSlcblx0XHRndWkuY2xvc2UoKVxuXG5cdFx0QGNvbnRhaW5lci5maWx0ZXJzID0gW2JsdXIsIG1ldGFiYWxsXVxuXHRcdHJldHVyblxuXG5cdHRyYW5zaXRpb25JbjooKS0+XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsQG9uTW91c2VNb3ZlKVxuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLEBvblRvdWNoTW92ZSlcblx0XHRzdXBlcigpXG5cdFx0cmV0dXJuXG5cblx0b25Ub3VjaE1vdmU6KGUpPT5cblx0XHRAbW91c2VQb3NpdGlvbi54ID0gZS50b3VjaGVzWzBdLnBhZ2VYLzJcblx0XHRAbW91c2VQb3NpdGlvbi55ID0gZS50b3VjaGVzWzBdLnBhZ2VZLzJcblx0XHRyZXR1cm5cblxuXHRvbk1vdXNlTW92ZTooZSk9PlxuXHRcdEBtb3VzZVBvc2l0aW9uLnggPSBlLnBhZ2VYXG5cdFx0QG1vdXNlUG9zaXRpb24ueSA9IGUucGFnZVlcblx0XHRyZXR1cm5cblxuXHR1cGRhdGU6KGR0KS0+XG5cdFx0aWYgQGJhY2tncm91bmRGaWx0ZXJcblx0XHRcdEBiYWNrZ3JvdW5kRmlsdGVyLnVuaWZvcm1zLnRpbWUudmFsdWU9TWF0aC5yYW5kb20oKSNkdCowLjAwMVxuXHRcdEBnaG9zdC5wb2ludHNbMF0ueCA9IEBtb3VzZVBvc2l0aW9uLngvQGdob3N0LnNjYWxlLnhcblx0XHRAZ2hvc3QucG9pbnRzWzBdLnkgPSBAbW91c2VQb3NpdGlvbi55L0BnaG9zdC5zY2FsZS55XG5cdFx0QGdob3N0LnVwZGF0ZSgpXG5cdFx0QGdob3N0Mi5zY2FsZS54ID0gQGdob3N0LnNjYWxlLnhcblx0XHRAZ2hvc3QyLnNjYWxlLnkgPSBAZ2hvc3Quc2NhbGUueVxuXHRcdCMgQGdob3N0Mi51cGRhdGUoKVxuXHRcdHJldHVyblxuXG5cdHJlc2l6ZTooKS0+XG5cdFx0QGJnLmNsZWFyKClcblx0XHRAYmcuYmVnaW5GaWxsKDB4RkYwMDAwLDEpXG5cdFx0QGJnLmRyYXdSZWN0KDAsMCx3aW5kb3cuaW5uZXJXaWR0aCx3aW5kb3cuaW5uZXJIZWlnaHQpXG5cdFx0QGJnLmVuZEZpbGwoKVxuXHRcdEBiZy5ib3VuZHMgPSBuZXcgUElYSS5SZWN0YW5nbGUoMCwwLHdpbmRvdy5pbm5lcldpZHRoLHdpbmRvdy5pbm5lckhlaWdodClcblx0XHRAaGFjay5wb3NpdGlvbi54ID0gd2luZG93LmlubmVyV2lkdGhcblx0XHRAaGFjay5wb3NpdGlvbi55ID0gd2luZG93LmlubmVySGVpZ2h0XG5cblx0XHRyZXR1cm5cblxuY2xhc3MgR2hvc3QgZXh0ZW5kcyBQSVhJLlJvcGVcblxuXHRjb25zdHJ1Y3RvcjoocG9pbnRzKS0+XG5cdFx0Y291bnQgPSA0MFxuXHRcdGlmKGlzTW9iaWxlLmFueSlcblx0XHRcdGNvdW50ID0gMjBcblx0XHRsZW5ndGggPSA0MDAgLyBjb3VudFxuXHRcdGlmKHBvaW50cz09dW5kZWZpbmVkKVxuXHRcdFx0cG9pbnRzID0gW11cblx0XHRcdGZvciBpIGluIFswLi4uY291bnRdIGJ5IDFcblx0XHRcdFx0cG9pbnRzLnB1c2gobmV3IFBJWEkuUG9pbnQoaSAqIGxlbmd0aCwgTWF0aC5yYW5kb20oKSozMCkpXG5cblx0XHR0ZXh0dXJlID0gUElYSS5UZXh0dXJlLmZyb21JbWFnZShcImltZy9naG9zdC5wbmdcIilcblx0XHRzdXBlcih0ZXh0dXJlLCBwb2ludHMpXG5cdFx0QHNjYWxlLnggPSAuNVxuXHRcdEBzY2FsZS55ID0gLjVcblx0XHQjIEB4ID0gLTQwMC8yO1xuXG5cblx0XHQjIEBhbHBoYSA9IC4xXG5cdFx0cmV0dXJuXG5cblx0dXBkYXRlOigpLT5cblxuXHRcdCMgQHBvaW50c1swXS54ICs9IE1hdGguY29zKEBhbmdsZSlcblx0XHQjIEBwb2ludHNbMF0ueSAtPSAxI01hdGguc2luKEBhbmdsZSlcblxuXHRcdGZvciBpIGluIFsxLi4uQHBvaW50cy5sZW5ndGhdIGJ5IDFcblx0XHRcdGN1cnJlbnQgPSBAcG9pbnRzW2ldXG5cdFx0XHRwcmV2aW91cyA9IEBwb2ludHNbaS0xXVxuXHRcdFx0ZHggPSBjdXJyZW50LnggLSBwcmV2aW91cy54XG5cdFx0XHRkeSA9IGN1cnJlbnQueSAtIHByZXZpb3VzLnlcblx0XHRcdGlmKChkeCpkeCtkeSpkeSk+MjUwKVxuXHRcdFx0XHRjdXJyZW50LnggKz0gKHByZXZpb3VzLnggLSBjdXJyZW50LngpKiguMjUraSouMDA1KVxuXHRcdFx0XHRjdXJyZW50LnkgKz0gKHByZXZpb3VzLnkgLSBjdXJyZW50LnkpKiguMjUraSouMDA1KSJdfQ==